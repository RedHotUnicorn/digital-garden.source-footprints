---
title: Первые агенты для самообучения сильного ИИ / Хабр
date: 2023-06-16
src_link: https://www.notion.so/b7dd8203246847e08f926229459fe69f
src_date: '2023-06-16 20:16:00'
gold_link: https://habr.com/ru/companies/ruvds/articles/740832/
gold_link_hash: 70389e0d65445f3eacb55a0bf2925a83
tags:
- '#host_habr_com'
---

[![](https://habrastorage.org/r/w1560/webt/v_/ee/mk/v_eemk29ae3ttuqjp35vmxkmtfy.png)](https://habr.com/ru/company/ruvds/blog/740832/)  

Тысячи учёных, программистов и просто энтузиастов по всему миру сейчас со всех сторон стараются подойти к главному изобретению в истории человечества, если оно будет сделано — это сильный ИИ (AGI, artificial general intelligence).  

  

Один из подходов к созданию AGI — самообучение так называемых агентов, то есть автономных систем, способных найти решение для произвольных задач и улучшать его до бесконечности. Результаты первых экспериментов интересные.  

  

Среди ранних экспериментов с агентами можно упомянуть [Auto-GPT](https://github.com/Significant-Gravitas/Auto-GPT), [BabyAGI](https://github.com/oliveirabruno01/babyagi-asi), [SuperAGI](https://github.com/TransformerOptimus/SuperAGI) и проч. Судя по всему, текущее поколение агентов родилось из [научной статьи](https://yoheinakajima.com/task-driven-autonomous-agent-utilizing-gpt-4-pinecone-and-langchain-for-diverse-applications/) Йохея Накадзимы (Yohei Nakajima) от 28 марта 2023 года.  

  

![](https://habrastorage.org/r/w1560/webt/gb/wp/8f/gbwp8fiau4jz_miai9z6ntmrjc0.png)  

*Иллюстрация из [оригинальной статьи](https://yoheinakajima.com/task-driven-autonomous-agent-utilizing-gpt-4-pinecone-and-langchain-for-diverse-applications/) со схемой работы агента*  

  

В минимальном варианте агент с самообучением — это скрипт для языковой модели (LLM), который выполняет поставленную задачу, затем автоматически составляет план по улучшению результата — и выполняет его по пунктам. Затем цикл рекурсивно повторяется. Например, один из первых агентов называется [Auto-GPT](https://github.com/Significant-Gravitas/Auto-GPT). В левой части экрана мы видим промт, который составляется по автоматически генерируемому плану, в правой части — результат работы LLM, то есть программный код, который генерируется в первоначальном виде, а потом улучшается.  

  

Конечно, всё это ранние версии, которые разработчики предпочитают нумеровать примерно как 0.01, то есть до реальных систем ещё далеко.  

  

▍ Первые агенты
---------------

  

[Auto-GPT](https://github.com/Significant-Gravitas/Auto-GPT), [BabyAGI](https://github.com/oliveirabruno01/babyagi-asi) и тому подобные программы работают по одному рекурсивному принципу: после получения задачи создаётся список подзадач, которые по результатам выполнения обновляются. После публикации исходного кода два месяца назад система Auto-GPT сразу вошла в число самых популярных репозиториев на Github. Спустя два месяца у неё 139 тыс. звёзд и более 29,1 тыс. форков.  

  

Принцип работы BabyAGI показан на КДПВ. Технически, это простой скрипт на Python, который выполняет определённую последовательность действий (промтов) внутри LLM. Если можно так выразиться, это «система управления задачами» (task management system, TMS) для LLM.  

  

![](https://habrastorage.org/r/w1560/webt/v_/ee/mk/v_eemk29ae3ttuqjp35vmxkmtfy.png)  

  

По умолчанию используется модель `gpt-3.5-turbo`. В противном случае следует изменить параметр `LLM_MODEL` или запускать промт напрямую. Для интеграции с Llama нужен пакет `llama-cpp` и веса модели, после чего указать путь к конкретной модели в `LLAMA_MODEL_PATH` — и можно запускать скрипт с параметром `LLM_MODEL=llama` или `-l`.  

  

Для работы `execution_agent()` и других функций скрипта требуется доступ к OpenAI API.  

  

Доступ к API предоставляется бесплатно всем зарегистрированным пользователям OpenAI, нужно просто сгенерировать новый ключ в разделе [API keys](https://platform.openai.com/account/api-keys).  

  

![](https://habrastorage.org/r/w1560/webt/fg/nw/bv/fgnwbvkkwtkxlzb4i0afy7iylnm.png)  

  

Функция `execution_agent()` принимает два параметра: цель и задача. Затем отправляет запрос в API, который возвращает результат выполнения задачи. Промт состоит из описания задачи, цели и самой задачи. Результат возвращается в виде строки.  

  

Функция `task_creation_agent()` вызывает API для создания новой задачи на основе цели и результата предыдущей задачи. Функция принимает четыре параметра: цель, результат предыдущей задачи, описание задачи и текущий список задач. Затем отправляет промт в API OpenAI, который возвращает список новых задач в виде строк. Функция возвращает новые задачи в виде списка «словарей» (dictionaries), где каждый словарь содержит название задачи.  

  

Функция `prioritization_agent()` изменяет приоритеты задач в списке. Функция принимает один параметр — идентификатор текущей задачи. Она отправляет запрос в API OpenAI, который возвращает список задач с изменёнными приоритетами в виде нумерованного списка.  

  

*OpenAI API*  

  

Для хранения и получения результатов задач (контекст) в BabyAGI используются векторные базы данных Chroma/Weaviate. Коллекция Chroma/Weaviate создаётся на основе имени таблицы, указанной в переменной `TABLE_NAME`. Результаты задач сохраняются с именем и любыми дополнительными метаданными.  

  

*Примечание*. Существует возможность запустить BabyAGI в онлайновой IDE типа [ReplIt](https://replit.com/), для этого в код требуется внести [некоторые изменения](https://twitter.com/yoheinakajima/status/1643403795895058434). Но в целом он нормально работает и тоже рекурсивно улучшает написанный код, как Auto-GPT из примера выше.  

  

Важно понимать, что скрипт рассчитан на непрерывную работу. Это может привести к высокой нагрузке на локальное оборудование или исчерпанию квоты на облачных сервисах/хостинге.  

  

▍ ToddlerAGI, SuperAGI и проч.
------------------------------

  

[ToddlerAGI](https://twitter.com/gogoliansnake/status/1643225698801164288) — один из многочисленных клонов BabyAGI c новыми идеями:  

  

![](https://habrastorage.org/r/w780q1/getpro/habr/post_images/402/ae5/64e/402ae564efdbdeb9315691aa88f065c1.jpg)  

  

Как видим на схеме, автор предлагает реализовать следующие концепции:  

  

* Многочисленные инстансы ToddlerAGI работают с единой БД
* Каждый инстанс выбирает случайные проблемы из базы и обучается с подкреплением, то есть с обратной связью от человека.

  

За счёт большого пула проблем и параллельной работы неограниченного количества инстансов ToddlerAGI улучшаются возможности по самообучению системы для решения универсальных задач, таких как проблема глобального потепления (оно приведено в качестве примера на иллюстрации).  

  

Ключевым элементом в разработке всех агентов является способность к самообучению. Если агент действительно автономный и научится самообучаться до бесконечности, то мы получим шанс на зарождение AGI. В апреле 2023 года была опубликована любопытная научная работа «[Генеративные агенты: Интерактивные симулякры человеческого поведения](https://arxiv.org/pdf/2304.03442.pdf)», в которой 25 программных агентов заселяют песочницу в стиле игры The Sims. Пользователи могут наблюдать и вмешиваться в работу агентов, которые планируют свой день, обмениваются новостями, формируют отношения и координируют групповую деятельность:  

  

![](https://habrastorage.org/r/w1560/webt/u_/sk/nf/u_sknfgn9o6ss1g3_mpv5ayaabm.png)  

  

![](https://habrastorage.org/r/w1560/webt/fp/np/zm/fpnpzmuiepnszwcjn12enhrk2bu.png)  

  

И кто скажет, что живые люди сильно отличаются от этих агентов, если посмотреть на модели поведения и активные подпрограммы/рутины?  

  

![](https://habrastorage.org/r/w1560/webt/3i/2k/r8/3i2kr8qb6ck9fiaouqnlbybbpmk.png)  

  

Недавно была создана [программная реализация](https://github.com/QuangBK/generativeAgent_LLM) генеративных агентов, описанных в статье.  

  

Уже появляются первые SaaS-платформы типа [SuperAGI](https://superagi.com//#gh-light-mode-only) для написания и запуска собственных рекуррентных агентов. Тут и многочисленные векторные СУБД на выбор, и удобный GUI для разработки (доступ к веб-приложению по инвайтам должен открыться в ближайшее время).  

  

![](https://habrastorage.org/r/w780q1/webt/wc/vw/kr/wcvwkrk9tnhigfq5palwvlumv2w.jpeg)  

*Фреймворк SuperAGI, слева вверху кнопка для создания агента*  

  

Кроме создания агентов, появились фреймворки типа [LangChain.js](https://github.com/hwchase17/langchainjs) и [Flowise](https://github.com/FlowiseAI/Flowise), специально разработанные для интеграции LLM с другими источниками информации или вычислительными системами.  

  

▍ Самовоспроизводящиеся машины
------------------------------

  

В первом приближении агенты ИИ напоминают [самовоспроизводящиеся машины](https://en.wikipedia.org/wiki/Self-replicating_machine) (СМ, машины фон Неймана) — тип автономных роботов, которые способны к самовоспроизводству с использованием материалов из окружающей среды, словно живые организмы. Концепция СМ была предложена и подробно описана в книгах Дрекслера и Мински «[Машины создания: Грядущая эра нанотехнологий](https://en.wikipedia.org/wiki/Engines_of_Creation)» (1986), а также Робертом Фрэйтосом и Ральфом Мерклом в книге [«Кинематика самовоспроизводящихся машин»](http://www.molecularassembler.com/KSRM.htm) (2004).  

  

Если самовоспроизводящиеся машины работают в нанометровых масштабах, то такой организм могут называть [серая слизь](https://ru.wikipedia.org/wiki/%D0%A1%D0%B5%D1%80%D0%B0%D1%8F_%D1%81%D0%BB%D0%B8%D0%B7%D1%8C), хотя сам термин связан с апокалиптическим сценарием развития человечества, который мы не рассматриваем.  

  

Конечно, эксперименты 2023 года с агентами ИИ не предполагают создание СМ, а только обучение программного агента до определённой степени. Но теоретически возможно и даже логично, что программный агент будет способен копировать себя полностью или частично между компьютерами для более эффективных параллельных вычислений, как в модели ToddlerAGI.  

  

▍ Сознание только мешает?
-------------------------

  

Сейчас энтузиасты на хакатонах экспериментируют не только с программными агентами, но и с физическими. Например, на видео показан процесс [самообучения работа-собаки за один час](https://old.reddit.com/r/ChatGPT/comments/142bzk3/selflearning_of_the_robot_in_1_hour/):  

  

Как говорится, дети быстро растут… Это наглядная демонстрация, как работает самообучение агентов в реальном мире.  

  

Вопрос в том, приведёт ли «бесконечное самообучение» к появлению самосознания? И породит ли самосознание свойственный человеку [эгоцентризм](https://en.wikipedia.org/wiki/Egocentrism), когда каждая человеческая особь считает себя самой важной, из-за чего сильно искажает объективную реальность в своём восприятии.  

  

Возможно ли создание сильного ИИ с самосознанием без эгоцентризма, с нормальным социальным мышлением, которое принимает в расчёт объективное благо для всего общества? Даже если такое возможно, некоторые учёные всё равно считают это [опасной идеей](https://amcs-community.org/open-letters/).  

  

Пока никто не знает истинных характеристик будущего AGI. Возможно, для полноценной работы он не нуждается в самосознании. Как в романе Питера Уоттса «[Ложная слепота](https://en.wikipedia.org/wiki/Blindsight_(Watts_novel))» у представителей высокоразвитой цивилизации вовсе отсутствует центральный мозг и сознание. Почему бы и нет.  

  

▍ Сколько до сингулярности
--------------------------

  

По [статистике Metaculus](https://www.metaculus.com/questions/3479/date-weakly-general-ai-is-publicly-known/), год назад средневзвешенный прогноз пользователей по сроку появления сильного ИИ приходился на 2043 год. В апреле 2022 года произошёл резкий сдвиг до 2028-го года. Потом срок ещё приблизился. На данный момент техносообщество сдвинуло наиболее вероятный срок ввода в эксплуатацию AGI в июне 2026 года (среднее медианное).  

  

![](https://habrastorage.org/r/w1560/webt/ff/fy/fg/fffyfgrfqtarjb3c6vcny3l7nyg.png)  

  

В последнее время появились библиотеки типа [GGML](https://github.com/ggerganov/ggml), позволяющие запускать современные модели LLM на персональных компьютерах с обычной конфигурацией. Наверняка это увеличит скорость научно-технического прогресса в данной области.  

  

![](https://habrastorage.org/webt/ru/ax/iy/ruaxiyaupl7e-n2zi4no7csn63s.gif)  

*Четыре инстанса [LLaMA](https://github.com/ggerganov/llama.cpp) 13B + [Whisper Small](https://github.com/ggerganov/whisper.cpp) на одном M1 Pro*  

  

По прогнозу футурологов, ввод в эксплуатацию сильного ИИ означает практически неизбежное наступление сингулярности. Поскольку человеческий мозг [в 10 млн раз медленнее компьютера](https://www.scientificamerican.com/article/what-is-the-memory-capacity/), при достижении паритета по умственным способностям очень удобно будет делегировать AGI большинство интеллектуальных задач. В этом случае человеку останется лишь задачи творчества и потребления. Вероятно, через небольшое время люди перестанут понимать суть новых изобретений AGI и мотивы его действий.  

  

По мнению некоторых футурологов, ситуация будет таковой, что если ты следуешь советам AGI, то получаешь отличное здоровье, хорошую работу и оптимального партнёра для жизни. Если отказываешься следовать советам — остаёшься в бедности и одиночестве (или с неоптимальным случайным партнёром). Очевидно, 99% людей выберет комфорт и с удовольствием будет подчиняться советам AGI, живя по оптимальному сценарию, и будут счастливы.  

  

Существует мнение, что сильный ИИ — это [единственная надежда на спасение человечества](https://pmarca.substack.com/p/why-ai-will-save-the-world). Иначе шансов мало, потому что по текущей траектории мы целенаправленно движемся в сторону самоуничтожения. Это весомый аргумент за то, чтобы передать AGI управление ключевыми процессами в обществе.  

  

[![](https://habrastorage.org/r/w780q1/webt/hc/88/sb/hc88sbzi7apcmcvqt2icby4azas.jpeg)](http://ruvds.com/ru-rub?utm_source=habr&utm_medium=article&utm_campaign=alizar&utm_content=pervye_agenty_dlya_samoobucheniya_silnogo_ii)