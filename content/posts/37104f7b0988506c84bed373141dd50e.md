---
title: –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ LAG –∏ LEAD –í –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø–æ—Å—Ç–µ –º—ã —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
  –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∞ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–π–¥–µ–º –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–∏–º–µ—Ä–∞–º –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü
date: 2022-12-04
src_link: https://www.notion.so/LAG-LEAD-7ad9b1e57f664f10938edfd6ef92c6b1
src_date: '2022-12-04 09:45:00'
gold_link: https://t.me/leftjoin/778?embed=1&mode=tme
gold_link_hash: 37104f7b0988506c84bed373141dd50e
tags:
- '#host_t_me'
---

**–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ LAG** **–∏** **LEAD**  
[–í –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø–æ—Å—Ç–µ](https://t.me/leftjoin/767) –º—ã —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∞ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–π–¥–µ–º –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–∏–º–µ—Ä–∞–º –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.   
  
**–§—É–Ω–∫—Ü–∏–∏ —Å–º–µ—â–µ–Ω–∏—è**   
–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º –æ–∫–Ω–∞.   
  
–§—É–Ω–∫—Ü–∏—è **LAG** –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –¥–∞–Ω–Ω—ã–º –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ –æ–∫–Ω–∞, –∞ **LEAD** ‚Äì –∫ –¥–∞–Ω–Ω—ã–º –∏–∑ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏. –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω—É–∂–Ω—ã –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ä–∞–≤–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–º. –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç —Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:   
- —Å—Ç–æ–ª–±–µ—Ü, –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–µ—Ä–Ω—É—Ç—å,   
- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –¥–ª—è —Å–º–µ—â–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1),   
- –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–µ—Ä–Ω—É—Ç—å, –µ—Å–ª–∏ –ø–æ—Å–ª–µ —Å–º–µ—â–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ NULL (–∫ –ø—Ä–∏–º–µ—Ä—É, –∫–æ–≥–¥–∞ –º—ã –∏—â–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –æ–∫–Ω–∞).  
  
–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Ç–∞–±–ª–∏—á–∫–∏ *orders*, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è LEAD. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —É–≤–∏–¥–µ—Ç—å —Ç–µ–∫—É—â—É—é –∏ —Å–ª–µ–¥—É—é—â—É—é –¥–∞—Ç—É –ø–æ–∫—É–ø–∫–∏, —Ç–æ –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:  
  

```
SELECT user_id,  
 order_date,  
 LEAD(order_date) OVER (PARTITION BY user_id ORDER BY order_date) as next_order_date,  
 receipt_no,  
 amount  
FROM orders
```
  
  
–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –≤ –ø–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–¥ –ø–æ—Å—Ç–æ–º ***üëá***  
  
–¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∫ —Ç–∞–±–ª–∏—á–∫–µ *orders*, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—á–∏—Ç–∞–µ—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫–∞–∂–¥–∞—è –ø–æ–∫—É–ø–∫–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ–ª—å—à–µ –∏–ª–∏ –º–µ–Ω—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π *(–µ—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø–æ–∫—É–ø–∫–∏ –Ω–µ –±—ã–ª–æ, –≤–æ–∑—å–º–∏—Ç–µ —Ç–µ–∫—É—â—É—é —Å—É–º–º–∫—É –ø–æ–∫—É–ø–∫–∏ –∏ –ø–æ–∫–∞–∂–∏—Ç–µ 0 –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü—É)*.  
  
#leftjoin\_sql